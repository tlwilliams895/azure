<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1.5. Studio: Running Code Anywhere &#8212; Microsoft Azure  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/site.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Infrastructure As A Service, Web APIs, REST" href="../web-apis/index.html" />
    <link rel="prev" title="1.4. Walkthrough: Connect to a Hosted Server" href="walkthrough.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body class="body-bc">

<div id="navbar" class="navbar navbar-default navbar-fixed-top">
   <div class="container">
     <div class="navbar-header">
       <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
       <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
       </button>
       <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
       </a>
       <span class="navbar-text navbar-version pull-left"><b></b></span>
     </div>

       <div class="collapse navbar-collapse nav-collapse">
         <ul class="nav navbar-nav">
           
           
             
           
           
           
           
           
         </ul>

         
           
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
         
       </div>
   </div>
 </div>

<ol class="breadcrumb container">
    <li><a href="../../index.html">Contents</a></li>
    <li><a href="index.html">1. Introduction to Cloud Hosting, Azure, and VMs</a></li>
    <li class="active">1.5. Studio: Running Code Anywhere</li>
</ol>



<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1 content ">

    
  <div class="section" id="studio-running-code-anywhere">
<h1>1.5. Studio: Running Code Anywhere<a class="headerlink" href="#studio-running-code-anywhere" title="Permalink to this headline">¶</a></h1>
<p>So far you have been writing and running your code on your <strong>local machine</strong>. This works well for development but in order to <em>host your application</em> on the internet you will need to run it on a <strong>remote machine</strong>.</p>
<p>Recall that when we <strong>publish</strong> our application we are creating a set of files that we can use to run it. Once we have published the application we gain the benefit of portability. We can take that executable bundle of files and run it on any other machine.</p>
<p>In today’s studio we’re going to practice the steps needed to run code on a different machine than where it was written. Each of you will partner with another student to practice cloning, publishing, executing, and connecting to each other’s applications.</p>
<div class="section" id="the-dev-side">
<h2>1.5.1. The Dev Side<a class="headerlink" href="#the-dev-side" title="Permalink to this headline">¶</a></h2>
<p>The application we will work with is a project we will be building up throughout the week as we introduce new topics. It is a basic REST web API with a SQLite database and a single resource – <code class="docutils literal notranslate"><span class="pre">CodingEvents</span></code>. The API has endpoints for CRUD operations to manage <code class="docutils literal notranslate"><span class="pre">CodingEvents</span></code>. In other words it exposes endpoints for Creating, Reading (the collection or a single resource), and Deleting <code class="docutils literal notranslate"><span class="pre">CodingEvents</span></code>.</p>
<p>Because web APIs are inherently <em>headless</em> (meaning they do not have a front-end like an MVC app) the project includes a tool called Swagger UI. This is a simple web page that documents the API and allows you to explore the endpoints with a built-in tool for executing requests.</p>
<p>We will cover web APIs, REST, and Swagger in greater detail tomorrow. So feel free to look over the code but don’t worry if it looks foreign to you! Today the goal is just to practice publishing, executing, and connecting across machines.</p>
<div class="section" id="fork-the-repo">
<h3>1.5.1.1. Fork the Repo<a class="headerlink" href="#fork-the-repo" title="Permalink to this headline">¶</a></h3>
<p>We will begin by forking the API repo onto our own accounts. This will allow us to make and push changes we make throughout the week.</p>
<p>First go to <a href="#id11"><span class="problematic" id="id12">`Coding Events API Repo&lt;https://github.com/launchcodeeducation/coding-events-api&gt;`_</span></a>.</p>
<p>At the top right corner select the <strong>Fork</strong> option:</p>
<img alt="../../_images/fork-repo.png" src="../../_images/fork-repo.png" />
<p>Once you have forked the repo you will be sent to the forked version under your GitHub account:</p>
<img alt="../../_images/forked-repo.png" src="../../_images/forked-repo.png" />
</div>
<div class="section" id="clone-the-forked-repo">
<h3>1.5.1.2. Clone the Forked Repo<a class="headerlink" href="#clone-the-forked-repo" title="Permalink to this headline">¶</a></h3>
<p>Copy the remote address using the green <strong>Clone or download</strong> button:</p>
<img alt="../../_images/clone.png" src="../../_images/clone.png" />
<p>Next clone the repo on your local machine. Make sure to clone the repo into a location you will remember.</p>
<p>The example below clones it into the <code class="docutils literal notranslate"><span class="pre">~/coding-projects/azure/coding-events-api</span></code> file path. If you already have a preferred location feel free to edit the command for that file path instead:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">set the cloned directory path wherever you’d like to clone the project</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/&lt;your username&gt;/coding-events-api.git ~/coding-projects/azure/coding-events-api
</pre></div>
</div>
</div>
<p>There are a number of branches that will correspond with the studios for each day. Today we will be working with the first one that has the basic version of the API.</p>
<p>Checkout the <code class="docutils literal notranslate"><span class="pre">1-sqlite</span></code> branch:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git checkout <span class="m">1</span>-sqlite
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-ops-side">
<h2>1.5.2. The Ops Side<a class="headerlink" href="#the-ops-side" title="Permalink to this headline">¶</a></h2>
<p>Before we get to running our own VM on Azure we need to get comfortable with the basics. Remember that virtual machines don’t have a graphical interface like your IDE. There won’t be a shiny green play button in the cloud to run your application. In fact, there won’t even be a mouse pointer!</p>
<p>We will simulate what it’s like to run our application in the cloud by going through similar steps locally from the command line. First on your own machine and then by swapping with your partner to publish and run each other’s code.</p>
<div class="admonition">
<p class="first admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p class="last">Before continuing make sure you have the tools you need. If you do not have the linux subsystem set up with the dotnet CLI tool refer to the ref::<cite>cli-setup</cite> page.</p>
</div>
<div class="section" id="publish-the-api">
<h3>1.5.2.1. Publish the API<a class="headerlink" href="#publish-the-api" title="Permalink to this headline">¶</a></h3>
<p>There are multiple ways to publish your project and even more to customize how it is packaged. In this course we will focus on the <a href="#id13"><span class="problematic" id="id14">`self-contained&lt;https://docs.microsoft.com/en-us/dotnet/core/deploying/#publish-self-contained&gt;`_</span></a> strategy with options to build a single executable project file. Rather than using our IDE we will use the <code class="docutils literal notranslate"><span class="pre">dotnet</span></code> CLI tool to get comfortable working from the command line.</p>
<p>First navigate to your cloned repo (solution) directory. In the cloning example above the path to that directory was <code class="docutils literal notranslate"><span class="pre">~/coding-projects/azure/coding-events-api</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~/coding-projects/azure/coding-events-api
</pre></div>
</div>
<p>From within the solution directory run the following command to publish your first Release:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">make sure to run this from the root (solution) directory</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ dotnet publish -c Release
</pre></div>
</div>
</div>
<p>This will publish to <code class="docutils literal notranslate"><span class="pre">CodingEventsAPI/bin/Release/netcoreapp3.1/linux-x64/publish/</span></code></p>
<p>Notice that it automatically published as a self-contained, single (executable) file, built to execute on the <code class="docutils literal notranslate"><span class="pre">linux-x64</span></code> runtime. These defaults were set in the <code class="docutils literal notranslate"><span class="pre">CodingEventsAPI/CodingEventsAPI.csproj</span></code> configuration file by the following attributes:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">CodingEventsAPI/CodingEventsAPI.csproj</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;Project</span> <span class="na">Sdk=</span><span class="s">&quot;Microsoft.NET.Sdk.Web&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;PropertyGroup&gt;</span>
      <span class="nt">&lt;SelfContained&gt;</span>true<span class="nt">&lt;/SelfContained&gt;</span>
      <span class="nt">&lt;PublishSingleFile&gt;</span>true<span class="nt">&lt;/PublishSingleFile&gt;</span>
      <span class="nt">&lt;RuntimeIdentifier&gt;</span>linux-x64<span class="nt">&lt;/RuntimeIdentifier&gt;</span>
</pre></div>
</div>
</div>
<p>These defaults are the equivalent of running the publish command with the following options:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">make sure to run this from the root (solution) directory</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ dotnet publish -c Release -r linux-x64 -p:PublishSingleFile<span class="o">=</span><span class="nb">true</span>
</pre></div>
</div>
</div>
<div class="admonition">
<p class="first admonition-title"><i class="fas fa-lightbulb" aria-hidden="true"></i>Tip</p>
<p class="last">If you change the <code class="docutils literal notranslate"><span class="pre">-r</span></code> option to a different <a class="reference external" href="https://docs.microsoft.com/en-us/dotnet/core/rid-catalog" target="_blank">RID value<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> you can build for other runtimes as needed while still using the defaults for the other options.</p>
</div>
</div>
<div class="section" id="execute-the-api">
<h3>1.5.2.2. Execute the API<a class="headerlink" href="#execute-the-api" title="Permalink to this headline">¶</a></h3>
<p>Within the <code class="docutils literal notranslate"><span class="pre">CodingEventsAPI/bin/Release/netcoreapp3.1/linux-x64/publish/</span></code> directory is the single executable file <code class="docutils literal notranslate"><span class="pre">CodingEventsAPI</span></code>. All you need to do to run it is execute that file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./CodingEventsAPI/bin/Release/netcoreapp3.1/linux-x64/publish/CodingEventsAPI
</pre></div>
</div>
<p>Now you can navigate to <a href="#id15"><span class="problematic" id="id16">`https://localhost:5001`_</span></a> and view the Swagger API documentation!</p>
</div>
</div>
<div class="section" id="running-on-a-remote-machine">
<h2>1.5.3. Running on a Remote Machine<a class="headerlink" href="#running-on-a-remote-machine" title="Permalink to this headline">¶</a></h2>
<p>After executing on your local machine it’s time to practice running on a “remote” machine. You and your partner will take turns as either the “<strong>remote server machine</strong>” or the “<strong>development machine</strong>”.</p>
<ul class="simple">
<li><strong>development machine</strong>: responsible for editing the API, pushing the changes, and sharing the repo address with your partner (<strong>remote server machine</strong>)</li>
<li><strong>remote server machine</strong>: responsible for cloning, publishing, and executing the updated API from your partner (<strong>development machine</strong>)</li>
</ul>
<div class="section" id="the-development-machine">
<h3>1.5.3.1. The Development Machine<a class="headerlink" href="#the-development-machine" title="Permalink to this headline">¶</a></h3>
<p>As the <strong>development machine</strong> you are simulating where the source code is developed (your local machine).</p>
<p>Open the <code class="docutils literal notranslate"><span class="pre">CodingEventsAPI/Startup.cs</span></code> file. then edit the code so your partner can tell it’s <em>your</em> Coding Events API.</p>
<div class="admonition">
<p class="first admonition-title"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i>Warning</p>
<p class="last">If you do not see the code on this line you are likely on the wrong branch. Make sure you are working on the <code class="docutils literal notranslate"><span class="pre">1-sqlite</span></code> branch before continuing.</p>
</div>
<p>You will see a configuration for Swagger on <code class="docutils literal notranslate"><span class="pre">line</span> <span class="pre">25</span></code>:</p>
<p>Change the <code class="docutils literal notranslate"><span class="pre">Title</span></code> of the UI to include your name. You can also customize the <code class="docutils literal notranslate"><span class="pre">Description</span></code> if you would like. Then commit and push your changes:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">run from the root (solution) directory</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git add .
$ git commit -m <span class="s2">&quot;made it my own!&quot;</span>
$ git push
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-remote-server-machine">
<h3>1.5.3.2. The Remote Server Machine<a class="headerlink" href="#the-remote-server-machine" title="Permalink to this headline">¶</a></h3>
<p>As the <strong>remote server machine</strong> you are simulating a virtual machine where application will be hosted.</p>
<p>Clone your partner’s repo. This time clone it into a different directory by prefixing the directory name with your partner’s name. Using the example path from before <code class="docutils literal notranslate"><span class="pre">~/coding-projects/azure/coding-events-api</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">set the cloned directory path wherever you’d like to clone the project</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/&lt;partner username&gt;/coding-events-api ~/coding-projects/azure/&lt;partner name&gt;-coding-events-api
</pre></div>
</div>
</div>
<p>Navigate to your partner’s cloned repo directory from the command line. Once in the directory run the publish command to package the API into its executable. After publishing execute the published executable just as you did earlier.</p>
<p>As the final step open the Swagger documentation page <a href="#id17"><span class="problematic" id="id18">`https://localhost:5001`_</span></a> in your browser.</p>
<div class="admonition-question admonition">
<p class="first admonition-title"><i class="fas fa-question" aria-hidden="true"></i>Question</p>
<p class="last">If your partner navigates to the same page on <em>their</em> laptop (<strong>development machine</strong>) do you think they will be able to see the page? Discuss your answer with each other then test it out.</p>
</div>
<p>Now switch roles with your partner and go through the steps again.</p>
</div>
<div class="section" id="reflect">
<h3>1.5.3.3. Reflect<a class="headerlink" href="#reflect" title="Permalink to this headline">¶</a></h3>
<p>While this exercise was only a simulation the steps involved will be the same when you host your API in an Azure VM. Development takes place on a local <strong>development machine</strong>. Hosting takes place in the cloud after publishing and executing.</p>
<p>Keep this in mind if you feel lost or overwhelmed when working on your studio tomorrow. Hosting an API in the cloud is no different than publishing and executing on a <strong>remote server machine</strong>. Whether that remote machine is your partner sitting next to your or virtualized in a publicly networked machine is immaterial.</p>
<div class="admonition-fun-fact admonition">
<p class="first admonition-title"><i class="fas fa-rocket" aria-hidden="true"></i>Fun Fact</p>
<p class="last">The modern development process to host an application through developing, publishing, and executing takes place on three different machines! Development takes place locally but a cloud-hosted <strong>CI Pipeline</strong> handles publishing (and other automated tasks). The execution itself takes place on a separate cloud-hosted machine like an Azure VM.</p>
</div>
</div>
</div>
<div class="section" id="connecting-over-a-network">
<h2>1.5.4. Connecting Over a Network<a class="headerlink" href="#connecting-over-a-network" title="Permalink to this headline">¶</a></h2>
<p>Earlier you discussed what would happen if you tried to access the documentation page running on your partner’s machine. You weren’t able to because <code class="docutils literal notranslate"><span class="pre">localhost</span></code> is just that – a <strong>local</strong> <strong>host</strong> name – mapped to the machine’s <strong>internal IP address</strong> <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code>. Recall that this address is only accessible from within the machine that is executing the application.</p>
<p>In order to access the page you need the <strong>network IP address</strong> of the machine and the <strong>server process port</strong>. Remember that every machine on a network is assigned a unique IP address. And every server process running on a machine has a port it listens on.</p>
<p>On the internet[work] every machine connected to it has its own IP address that uniquely identifies it across the entire network called the <strong>public IP address</strong>. But on the WiFi (WAN) network your laptop (machine) is connected to it has been assigned an <em>internal</em> IP address that uniquely identifies it called its <strong>private IP address</strong>.</p>
<p>In this section we will take our first step towards connecting to a machine hosted on a network. Before diving into the vast seas of the open internet we will practice within the smaller pond of the WiFi network.</p>
<div class="section" id="instructor">
<h3>1.5.4.1. Instructor<a class="headerlink" href="#instructor" title="Permalink to this headline">¶</a></h3>
<p>Your instructor will now play the <strong>remote server machine</strong> by publishing and executing the API. Then they will identify their machine’s <strong>private IP address</strong> on the WAN and distribute it to the class.</p>
</div>
<div class="section" id="student">
<h3>1.5.4.2. Student<a class="headerlink" href="#student" title="Permalink to this headline">¶</a></h3>
<p>Navigate to your instructor’s machine IP address in your browser. Don’t forget that you <strong>have to include the port</strong> in order to view their hosted documentation.</p>
<div class="admonition-question admonition">
<p class="first admonition-title"><i class="fas fa-question" aria-hidden="true"></i>Question</p>
<p class="last">Why did you have to include the port? Why don’t you typically need to include it when accessing sites on the internet?</p>
</div>
</div>
<div class="section" id="id1">
<h3>1.5.4.3. Reflect<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Earlier you learned how hosting on a <strong>remote server machine</strong> is functionally the same whether it takes place on a partner’s laptop or a VM in the cloud. Connecting to machines that are hosted on a network is equally analogous from a small WAN like the WiFI to the open internet itself.</p>
<p>Remember that everything that happens in the cloud, as mysterious and elusive as it may seem, is just a virtualized representation of what happens in the physical world. It often feels like magic, and it arguably is, but it follows the same logical principles that it was designed to simulate.</p>
</div>
</div>
<div class="section" id="bonus">
<h2>1.5.5. Bonus<a class="headerlink" href="#bonus" title="Permalink to this headline">¶</a></h2>
<p>If you want to try connecting to your partner’s machine over the WAN you can use one of the following commands to identify each other’s network IP addresses and share them with each other. Don’t forget to start the server first!</p>
<div class="admonition">
<p class="first admonition-title"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i>Warning</p>
<p class="last">As a security best practice do not leave server processes listening on exposed ports running unattended while connected to a public network. We will learn about how to use firewalls and Azure networking rules to protect our VM later in the course.</p>
</div>
<p>Select the command for your OS:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Linux with Bash or ZSH</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ hostname -I
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">OSX with Bash or ZSH</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># the inet address is your machine&#39;s IP</span>
$ ifconfig en0
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">Windows with PowerShell</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># the IPv4 entry is your machine&#39;s IP</span>
<span class="p">$</span> <span class="n">ipconfig</span>
</pre></div>
</div>
</div>
</div>
</div>



    
    <nav aria-label="Next and Previous Pages">
      <ul class="pager">
        
        <li class="previous"><a href="walkthrough.html"><span aria-hidden="true">&larr;</span> 1.4. Walkthrough: Connect to a Hosted Server</a></li>
        
        
        <li class="next"><a href="../web-apis/index.html">2. Infrastructure As A Service, Web APIs, REST <span aria-hidden="true">&rarr;</span></a></li>
        
      </ul>
    </nav>
    
    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/chapters/azure-intro/studio.rst.txt"
     rel="nofollow">Page Source</a>
</div>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>